<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>URLPlus</title>
    <link rel="stylesheet" type="text/css" href="css/base.css" />
    <link rel="stylesheet" type="text/css" href="css/att.css" />
    <link rel="stylesheet" type="text/css" href="css/uploadify.css" />
    <script type="text/javascript" src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="js/jquery.uploadify-3.1.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui-1.9.1.custom.min.js"></script>
    <script type="text/javascript" src="js/galleria/galleria-1.2.8.js"></script>
    <script type="text/javascript" src="js/jquery-urlplus-1.0.js"></script>
   </head>
  <body>

	<script type="text/javascript">
    $(document).ready(function(){
        
        var thumbData = []; // thumb data

        $('#imgOne_upload').uploadify( uplodify_one() );//#imgOne_upload

		$('#imgThumbnail_upload').uploadify( uplodify_thumb("imgThumbnail_box") );//#imgThumbnail_upload

        $('#imgSlide_upload').uploadify( uplodify_slide('imgSlide_box') );//#imgSlide_upload
        
    }) // $(document).ready


    var start_pos = 0;
    var end_pos = 0;
    function thumbSortAble(b) {
        if (b) {
            $('#imgThumbnail_box').sortable({
                cursor: "move",
                start: function(event, ui) {
                    var sp = ui.item.index();
                    ui.item.data('start_pos', sp);
                },
                change: function(event, ui) {
                    start_pos = ui.item.data('start_pos');
                    end_pos = ui.placeholder.index();
                   
                    if (start_pos < end_pos) end_pos -= 1;
                     de(start_pos+"=>"+end_pos);

                },
                update: function(event, ui) {
                    de("end!! : "+start_pos+"=>"+end_pos);
                     $("#imgThumbnail_box").thumbNail("thumbSort", start_pos, end_pos);
                }
            });

            $("#imgThumbnail_box").disableSelection();

            $('#imgThumbnail_box > li > img.imgdel').hide();
            alert("이미지를 드래그 하여 순서를 변경하세요.");
        } else {
            $("#imgThumbnail_box").sortable( "destroy" );
            $("#imgThumbnail_box").thumbNail("reload");
            $('#imgThumbnail_box > li > img.imgdel').show();
            alert("이동모드가 해제 되었습니다.");
        }
    }


    var slideData = []; // slide data
    var bSlideRun = false;

    
	
    /**
    * slide all remove click handler
    */
    function slideDataRemoveAll() {
        slideData = [];
        var gallery = Galleria.get(0);
        gallery.setOptions('dataSource', slideData);
        gallery.load();
        $('#imgSlide_box').hide();
    }
    /**
    * slide drag & drop enable
    */
    var start_slide_pos = 0;
    var end_slide_pos = 0;
	function slideSortAble(b) {
        if (b) {
            $("#imgSlide_box").hide();
            $("#imgSlide_move_box").show();

            slideMoveView();

            $('#imgSlide_move_box').sortable({
                cursor: "move",
                start: function(event, ui) {
                    var sp = ui.item.index();
                    ui.item.data('start_pos', sp);
                },
                change: function(event, ui) {
                    start_slide_pos = ui.item.data('start_pos');
                    end_slide_pos = ui.placeholder.index();
                   
                    if (start_slide_pos < end_slide_pos) end_slide_pos -= 1;
                     de(start_slide_pos+"=>"+end_slide_pos);

                },
                update: function(event, ui) {
                    de("end!! : "+start_slide_pos+"=>"+end_slide_pos);
                    slideData.move( start_slide_pos, end_slide_pos);
                }
            });
            $("#imgSlide_move_box").disableSelection();
            alert("이미지를 드래그 하여 순서를 변경하세요.");

        } else {
            $("#imgSlide_move_box").sortable( "destroy" );
            $("#imgSlide_move_box").hide();

            $("#imgSlide_box").show();
            slideView();
            alert("이동모드가 해제 되었습니다.");
        }
    }

    function slideMoveView() {

        $('#imgSlide_move_box').empty();
        var html = "";
        var cnt = slideData.length;
        var obj = null;
        for ( var i = 0; i < cnt ; i++ ) {
            obj = slideData[i];
            html += '<li><img src="'+obj.thumb+'" /></li>';
        }
        $('#imgSlide_move_box').html(html);
    }



function de(msg) {
    $('#debug').val($('#debug').val()+"\r\n"+msg);
}
	</script>


<button onclick="al()">dafdasf</button>
  	<h1>속성</h1>
  	<dl>
  		<dt>이미지 1장</dt>
  		<dd>
  			<div id="imgOne_wrap">
  				<div id="imgOne_box"></div>
  				<input type="file" name="imgOne_upload" id="imgOne_upload" />
  			</div>
  		</dd>
  		<dt>이미지 썸네일</dt>
  		<dd>
  			<div id="imgThumbnail_wrap">
  				<ul id="imgThumbnail_box">asd</ul>
  				<input type="file" name="imgThumbnail_upload" id="imgThumbnail_upload" />
  				<a href="#" onclick="$('#imgThumbnail_box').thumbNail('RemoveAllData');">모두삭제</a>
                <a href="#" onclick="thumbSortAble(true)">이동모드</a>
                <a href="#" onclick="thumbSortAble(false)">이동해제</a>
  			</div>
  		</dd>
        <dt>이미지 슬라이드</dt>
  		<dd>
  			<div id="imgSlide_wrap">
  				<div id="imgSlide_box"></div>
                <div id="imgSlide_move_box"></div>
  				<input type="file" name="imgSlide_upload" id="imgSlide_upload" />
  				<a href="#" onclick="slideDataRemoveAll()">모두삭제</a>
                <a href="#" onclick="slideSortAble(true)">이동모드</a>
                <a href="#" onclick="slideSortAble(false)">이동해제</a>
  			</div>
  		</dd>
  	</dl>
  	<textarea id="debug" rows="40" cols="100" style="position:absolute;left:500px;top:10px;"></textarea>
  </body>
</html>

