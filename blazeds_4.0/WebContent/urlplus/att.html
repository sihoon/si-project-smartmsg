<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>URLPlus</title>
    <link rel="stylesheet" type="text/css" href="css/base.css" />
    <link rel="stylesheet" type="text/css" href="css/att.css" />
    <link rel="stylesheet" type="text/css" href="css/uploadify.css" />
    <script type="text/javascript" src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="js/jquery.uploadify-3.1.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui-1.9.1.custom.min.js"></script>
   </head>
  <body>
  

	
	
	<script type="text/javascript">
	
	
	var imageOver = '<span style="display:none;"><a href="#" ><img src="_images/img_del.gif" width="18" height="18" /></a></span>';
	
	$(function() {
		$('#imgOne_upload').uploadify({
			'swf'      : 'js/uploadify.swf', // 파일업로드 이벤트 가로채틑 flash
			'uploader' : 'uploadify.jsp', // 비동기 업로드시 처리 url
			'fileTypeDesc' : 'Image Files',
	        'fileTypeExts' : '*.gif; *.jpg; *.png',
			'buttonText' : '이미지등록',
			'removeTimeout' : 1, // queue 제거 시간
			'multi' : false, // 다중업로드
 			'onUploadSuccess' : function(file, data, response) {
 				
 				$('#debug').val($('#debug').val()+"\r\n"+file+"/"+data+"/"+response);
 				var rslt;
 				try {
 					rslt = jQuery.parseJSON(data);
 					alert(rslt.b );
 					if (rslt.b == "true") {
 	 	 				if ($('#imgOne').length > 0) $('#imgOne').attr('src','/urlImage/'+rslt.img);
 	 	 				else $('#imgOne_box').append('<img id="imgOne" src="'+"/urlImage/"+rslt.img+'" />');
 					} else {
 						alert("에러 : "+rslt.err);
 					}
 	 				
 				}catch(err){ alert("업로드 실패");}
        	}
 			
		});
		
		
		$('#imgThumbnail_upload').uploadify({
			'swf'      		: 'js/uploadify.swf', 	// 파일업로드 이벤트 가로채틑 flash
			'uploader' 		: 'uploadifyMulti.jsp', // 비동기 업로드시 처리 url
			'fileTypeDesc'	: 'Image Files',
	        'fileTypeExts'	: '*.gif; *.jpg; *.png',
			'buttonText'	: '이미지등록',
			'removeTimeout' : 1, 					// queue 제거 시간
			'multi' 		: true, 				// 다중업로드
 			'onUploadSuccess' : function(file, data, response) {
 				
 				$('#debug').val($('#debug').val()+"\r\n"+file+"/"+data+"/"+response);
 				var rslt;
 				try {
 					rslt = $.parseJSON(data);
 					
 					if (rslt.b == "true")
 						$('#imgThumbnail_box').append('<li><img id="imgThumbnail" src="'+"/urlImage/thumb/"+rslt.img+'" width="100" height="100" />'+imageOver+'</li>');
 					else
 						alert("에러 : "+rslt.err);
 	 				
 				}catch(err){ alert("업로드 실패"); }
 				
        	},
        	
        	'onQueueComplete' : function(queueData) {
        		
        		// 마우스 오버시 UI 변경
        		$("#imgThumbnail_box > li").mouseover(function(){ $(this).children("span").show();}
        			).mouseout(function(){ $(this).children("span").hide(); }
        		);
        		
        		// 삭제 클릭시 처리
        		$("#imgThumbnail_box > li > span > a").click(function(){
        			$(this).parent().parent().remove();
        		});
        		
                alert("총 " + $("#imgThumbnail_box").children().length + " 개의 이미지가 업로드 되어 있습니다.");
            }
 			
		});
	});
	
	
	function thumb_alldel() {
		$("#imgThumbnail_box > li").remove();
		return false;
	}
	
	$(function() {
	        $( "#imgThumbnail_box" ).sortable();
			$( "#imgThumbnail_box" ).disableSelection();

    });
	
	
	</script>
	<style>
    .demo ul { list-style-type: none; margin: 0; padding: 0; margin-bottom: 10px; }
    .demo li { margin: 5px; padding: 5px; width: 150px; }
    </style>
  
  	<ul id="sortable" class="ui-sortable">
            <li class="ui-state-default">Item 1</li>
            <li class="ui-state-default">Item 2</li>
            <li class="ui-state-default">Item 3</li>
            <li class="ui-state-default">Item 4</li>
            <li class="ui-state-default">Item 5</li>
        </ul>
  	<h1>속성</h1>
  	<dl>
  		<dt>이미지 1장</dt>
  		<dd>
  			<div id="imgOne_wrap">
  				<div id="imgOne_box"></div>
  				<input type="file" name="imgOne_upload" id="imgOne_upload" />
  			</div>
  		</dd>
  		<dt>이미지 썸네일</dt>
  		<dd>
  			<div id="imgThumbnail_wrap">
  				<ul id="imgThumbnail_box"></ul>
  				<input type="file" name="imgThumbnail_upload" id="imgThumbnail_upload" />
  				<a href="#" onclick="thumb_alldel()">모두삭제</a>
  			</div>
  		</dd>
  	</dl>
  	<textarea id="debug" rows="10" cols="100"></textarea>
  </body>
</html>

