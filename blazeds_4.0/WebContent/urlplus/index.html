<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>URLPlus</title>
    <link rel="stylesheet" type="text/css" href="css/base.css" />
    <link rel="stylesheet" type="text/css" href="css/att.css" />
	
	<link rel="stylesheet" href="js/editor/css/editor.css" type="text/css" charset="utf-8"/>
	<script src="js/editor/js/editor_loader.js?environment=development" type="text/javascript" charset="utf-8"></script>
	
	<link rel="stylesheet" type="text/css" href="css/jquery-ui-1.9.2.custom.min.css" />
	<script src="js/jquery-1.8.2.js"></script>
    <script src="js/jquery-ui.js"></script>
	
	
	<script type="text/javascript" src="js/jquery.uploadify-3.1.min.js"></script>

    <script type="text/javascript" src="js/galleria/galleria-1.2.8.js"></script>
	<script type="text/javascript" src="js/masonry/jquery.masonry.min.js"></script>
	
	<script type="text/javascript" src="js/barcode/jquery-barcode-2.0.2.min.js"></script>
	<script type="text/javascript" src="js/tinyscrollbar/jquery.tinyscrollbar.min.js"></script>
	
	<script type="text/javascript" src="js/jquery-urlplus-0.1.0.js"></script>

    <style type="text/css" media="screen">
		#container{ width:600px; }
		textarea{ width:500px; height:300px; }
	</style>

   </head>
  <body>

	<script type="text/javascript">
	
	
	var PAGE_EDITING = false; // 현재 페이지 수정 여부
	var scrollUpdate = function(){ 	$('#scroll_wrap').tinyscrollbar_update();};
	var scrollUpdateBottom = function(){ 	$('#scroll_wrap').tinyscrollbar_update('bottom');};
	
	
	// testData
	var testImageOne = {imageData : {image:"", link:"", merge: $.URLPLUS.getMERGE_IMAGE_TAG()}  , bEdit:true};
	var testImageOne2 = { imageData : {image: "1.png", link:"http://ddr.html", merge: "" }  , bEdit:true };
	var testImage = [
	                 {image: '/urlImage/1.png', thumb: '/urlImage/thumb/1.png', link :'', merge : '' },
	                 {image: '/urlImage/2.png', thumb: '/urlImage/thumb/2.jpg', link :'', merge : '' },
	                 {image: '/urlImage/3.png', thumb: '/urlImage/thumb/3.jpg', link :'', merge : '' },
	                 {image: '/urlImage/4.jpg', thumb: '/urlImage/thumb/4.jpg', link :'', merge : '' },
	                 {image: '/urlImage/5.jpg', thumb: '/urlImage/thumb/5.jpg', link :'', merge : '' },
	                 {image: '/urlImage/6.png', thumb: '/urlImage/thumb/6.jpg', link :'', merge : '' },
	                 {image: '/urlImage/7.jpg', thumb: '/urlImage/thumb/7.jpg', link :'', merge : '' }
	                ];
	
	var testSlideData = [
							{image: '/urlImage/1.png', thumb: '/urlImage/thumb/1.png', big: '', link: '', bMovie: false },
							{image: '/urlImage/2.png', thumb: '/urlImage/thumb/2.jpg', big: '', link: '', bMovie: false },
							{image: '/urlImage/3.png', thumb: '/urlImage/thumb/3.jpg', big: '', link: '', bMovie: false },
							{image: '/urlImage/4.jpg', thumb: '/urlImage/thumb/4.jpg', big: '', link: '', bMovie: false },
							{image: '/urlImage/5.jpg', thumb: '/urlImage/thumb/5.jpg', big: '', link: '', bMovie: false },
							{image: '/urlImage/3.png', thumb: '/urlImage/thumb/3.jpg', big: '', link: '', bMovie: false },
							{image: '/urlImage/4.jpg', thumb: '/urlImage/thumb/4.jpg', big: '', link: '', bMovie: false },
							{image: '/urlImage/5.jpg', thumb: '/urlImage/thumb/5.jpg', big: '', link: '', bMovie: false },
	                     ];
	var testMovieOneData = {bEdit : true, readyEvent: scrollUpdateBottom, 'movieData' : {image:"5.jpg", link:""}};
	
	var testLayout = [
	                 {image: '/urlImage/1.png', width: 100, height:50 },
	                 {image: '/urlImage/2.png', width: 200, height:50 },
	                 {image: '/urlImage/3.png', width: 300, height:50 },
	                 {image: '/urlImage/4.jpg', width: 100, height:50 }
	                ];
	
	var testLinkInput = [{bPhone:true,linkInputType:"text", linkInputName:"바로", nextPage:1, linkInputURL:"http://www.naver.com"},{bPhone:true,linkInputType:"text", linkInputName:"바로", nextPage:1, linkInputURL:"http://www.naver.com"}];
	var testLinkInputText = [{bPhone:false,linkInputType:"text", linkInputName:"바로", nextPage:"page", linkInputURL:"http://www.naver.com"},{bPhone:false,linkInputType:"page", linkInputName:"바로", nextPage:1, linkInputURL:"http://www.naver.com"}];

    $(document).ready(function(){
		
		$('#scroll_wrap').tinyscrollbar();
		tabView();


    }) // $(document).ready

	function tabView() {
		$('#editeCanvas > .editor_box').html("");

		var tab = $('#tabs > li > a.on:first').attr('href');
		if (tab == "#tabs-1") {
			//addAtt('imageOne');
			//addAtt('imageThumb');
			//addAtt('textInput');
			
			
		}else if (tab == "#tabs-2") {
			addAtt('imgSlide');
		}else if (tab == "#tabs-3") {
			addAtt('imgLayout');
		}
		scrollUpdate();
	}

	function tabChange(index) {
		$('#tabs > li > a').attr('class','');
		$('#tabs > li > a[href="#tabs-'+index+'"]').attr('class', 'on');
		tabView();

	}
	
	/** 
	* type 에 따라 속성들을 추가한다.
	* type : 속성 명
	*/
	function addAtt(type) {

		var target = getEditeEle();
		var box = "<li class='attBox'></li>";
		var addBoxEle = null;
		var subBoxEle = null;
		
		if (type == "imageOne") { addBoxEle = $(box).appendTo(target).imageOne({bEdit : true}); }
		else if (type == "imageThumb") { addBoxEle = $(box).appendTo(target).imageThumb({bEdit : true, thumbData:testImage }); }
		else if (type == "imgSlide") {

			if ( $('.imageSlide_box , .movieSlide_box').length > 0 ){
				alert("슬라이드, 동영상 이미지는 페이지당 하나만 추가 가능 합니다.");
			} else {
				addBoxEle = $(box).appendTo(target).imageSlide({slideData : testSlideData,bEdit : true});
			}
			
		}
		else if (type == "imgLayout") { addBoxEle = $(box).appendTo(target).imageLayout({bEdit : true, layoutData: testLayout}); }
		//else if (type == "movieOne") { addBoxEle = $(box).appendTo(target).movieOne({bEdit : true, readyEvent: scrollUpdateBottom}); }
		else if (type == "movieOne") { addBoxEle = $(box).appendTo(target).movieOne(testMovieOneData); }
		else if (type == "movieSlide") {

			if ( $('.imageSlide_box , .movieSlide_box').length > 0 ){
				alert("슬라이드, 동영상 이미지는 페이지당 하나만 추가 가능 합니다.");
			} else {
				addBoxEle = $(box).appendTo(target).imageSlide({slideData : testSlideData,bEdit : true});
			}
		}
		else if (type == "text") { addBoxEle = $(box).appendTo(target).textEditor({domUrl : 'textEditor.jsp', readyEvent: scrollUpdateBottom, data:"<p>hi</p>" }); }
		else if (type == "textInput") { addBoxEle = $(box).appendTo(target).textInput({bEdit : true, data : {textInputType: "comment", keywordText: "정답입니다.", nextPage: 0, keywordCheck: "squence", keywordCheckCntsq: 0, keywordCheckCntrn: 0, startDate: "", endDate: ""}}); }
		else if (type == "textTable") { addBoxEle = $(box).appendTo(target).textEditor({domUrl : 'textEditorTable.jsp', bTable : true, readyEvent: scrollUpdateBottom, data:"<p>hi</p>" }); }
		else if (type == "linkPhone") { addBoxEle = $(box).appendTo(target).linkInput({bEdit : true, bPhone : true, linkData:testLinkInput}); }
		else if (type == "linkPage") { addBoxEle = $(box).appendTo(target).linkInput({bEdit : true, linkData:testLinkInputText}); }
		else if (type == "linkEnter") { addBoxEle = $(box).appendTo(target).textInput({bEdit : true, bInput:false}); }
		else if (type == "cuponBarcode") { 
			if ($('.couponBox').length > 0) {
				alert("쿠폰은 페이지당 하나만 추가 가능 합니다.");
				return ;
			}else {
				addBoxEle = $(box).appendTo(target).coupon({bEdit : true, bBarcode : true});
				subBoxEle = $(box).appendTo(target).couponBtn({bEdit : true});
				addFunctionToAttBoxNoDel(type, subBoxEle);	
			}
			
		}
		else if (type == "cuponText") { 
			
			if ($('.couponBox').length > 0) {
				alert("쿠폰은 페이지당 하나만 추가 가능 합니다.");
				return ;
			}else {
				addBoxEle = $(box).appendTo(target).coupon({bEdit : true});
				subBoxEle = $(box).appendTo(target).couponBtn({bEdit : true});
				addFunctionToAttBoxNoDel(type, subBoxEle);
			}
		}
		else if (type == "faceBook") {addBoxEle = $(box).appendTo(target).facebook({bEdit : true});}
		else if (type == "html") {addBoxEle = $(box).appendTo(target).htmlWrite({bEdit : true});}
		else if (type == "bar") {addBoxEle = $(box).appendTo(target).bar({bEdit : true});}
		

		addFunctionToAttBox(type, addBoxEle);

		scrollUpdateBottom();
		
		
		return false;
	}
	/** 
	* 현재 활성화 tab의 수정 element를 반환함.
	*/
	function getEditeEle() {
		return $('#editeCanvas> .editor_box');
	}
	/** 
	* target 에 위로, 아래로, 삭제 기능을 추가 한다.
	* target : 속성 element
	*/
	function addFunctionToAttBox( type, addBoxEle ) {

		var tid = addBoxEle.attr("id");
		var dom = '<div class="attBox_function title_'+type+'"><a href="#" onclick="attBoxFunction(\''+type+'\',\''+tid+'\', this, \'remove\');return false;" class="remove" alt="삭제">X</a><a href="#" onclick="attBoxFunction(\''+type+'\',\''+tid+'\', this, \'down\');return false;" class="down" alt="아래로">▼</a><a href="#" onclick="attBoxFunction(\''+type+'\',\''+tid+'\', this, \'up\');return false;" class="up" alt="위로">▲</a></div>';
		$(dom).appendTo(addBoxEle);
	}
	/** 
	* target 에 위로, 아래로을 추가 한다.
	* target : 속성 element
	*/
	function addFunctionToAttBoxNoDel( type, addBoxEle ) {

		var tid = addBoxEle.attr("id");
		var dom = '<div class="attBox_function"><a href="#" onclick="attBoxFunction(\''+type+'\',\''+tid+'\', this, \'down\');return false;" class="down_only" alt="아래로">▼</a><a href="#" onclick="attBoxFunction(\''+type+'\',\''+tid+'\', this, \'up\');return false;" class="up" alt="위로">▲</a></div>';
		$(dom).appendTo(addBoxEle);
	}
	/** 
	* 위로, 아래로, 삭제 이벤트 처리
	* target : 속성 element
	*/
	function attBoxFunction(type, tid, ele, opt) {

		var target = $(ele);

		if (opt == "remove"){

			if (type == "imageOne") { $('#'+tid).imageOne('destroy');}
			else if (type == "imageThumb") { $('#'+tid).imageThumb('destroy'); }
			else if (type == "imgSlide") { $('#'+tid).imageSlide('destroy'); }
			else if (type == "imgLayout") { $('#'+tid).imageLayout('destroy'); }
			else if (type == "movieOne") { $('#'+tid).movieOne('destroy'); }
			else if (type == "movieSlide") { $('#'+tid).movieSlide('destroy'); }
			else if (type == "cuponBarcode" || type == "cuponText") { $('.coupon_button_wrap').parent().remove(); } // coupon button remove;
			
			target.parent().parent().remove();
			scrollUpdateBottom();
		}else if (opt == "up"){
			target.parent().parent().prev().insertAfter( target.parent().parent() );
		}else if (opt == "down"){
			target.parent().parent().next().insertBefore( target.parent().parent() );
		}
	}
	
	

	function test() {
		//Editor.getToolbar().tools.table.button._command();
		$("#editor_box").result();
		//alert(Editor.getContent());
		//document.getElementById('ttt').value = Editor.getContent();

		//for (var _name in _tools) {
 		//			alert(_name);
		//}
	}
	
	function addText() {
		Editor.getCanvas().pasteContent('<button>{DATA}</button>');
	}
	
	</script>
	<!--
	<textarea id="ttt"></textarea> -->
	<button onclick="test()">html</button>
	<div id="wrap">
		<div id="header">
			<h1><a href="#"><img src="_images/logo.png" alt="모바일웹에디터"/></a></h1>
			<ul id="tabs">
				<li class="mainmenu1"><a href="#tabs-1" class="on" onclick="tabChange(1)">정보형</a></li>
				<li class="mainmenu2"><a href="#tabs-2" onclick="tabChange(2)">쿠폰형</a></li>
				<li class="mainmenu3"><a href="#tabs-3" onclick="tabChange(3)">이벤트형</a></li>
			</ul>
		</div><!--// header -->

		<div id="att">
			<h2 class="image">이미지</h2>
			<ul>
				<li class="image_one"><a href="#" onclick="addAtt('imageOne');return false;">이미지 1장</a></li>
				<li class="image_thumb"><a href="#" onclick="addAtt('imageThumb');return false;">썸네일 이미지</a></li>
				<li class="image_slide"><a href="#" onclick="addAtt('imgSlide');return false;">슬라이드</a></li>
				<li class="image_layout"><a href="#" onclick="addAtt('imgLayout');return false;">분할이미지</a></li>
			</ul>
			
			<h2  class="movie">동영상</h2>
			<ul>
				<li class="movie_one"><a href="#" onclick="addAtt('movieOne');return false;">동영상 1개</a></li>
				<li class="movie_slide"><a href="#" onclick="addAtt('movieSlide');return false;">동영상 슬라이드</a></li>
			</ul>

			<h2  class="text">텍스트</h2>
			<ul>
				<li class="text_box"><a href="#" onclick="addAtt('text');return false;">텍스트 상자</a></li>
				<li class="text_input"><a href="#" onclick="addAtt('textInput');return false;">텍스트 입력</a></li>
				<li class="text_table"><a href="#" onclick="addAtt('textTable');return false;">표</a></li>
			</ul>

			<h2  class="link">링크</h2>
			<ul>
				<li class="link_phone"><a href="#" onclick="addAtt('linkPhone');return false;">전화번호 링크</a></li>
				<li class="link_web"><a href="#" onclick="addAtt('linkPage');return false;">웹페이지 링크</a></li>
				<li class="link_enter"><a href="#" onclick="addAtt('linkEnter');return false;">응모하기링크</a></li>
			</ul>

			<h2  class="coupon">쿠폰</h2>
			<ul>
				<li class="coupon_barcode"><a href="#" onclick="addAtt('cuponBarcode');return false;">바코드 쿠폰</a></li>
				<li class="coupon_text"><a href="#" onclick="addAtt('cuponText');return false;">텍스트 쿠폰</a></li>
			</ul>

			<h2  class="etc">기타</h2>
			<ul>
				<li class="etc_facebook"><a href="#" onclick="addAtt('faceBook');return false;">페이스북 좋아요</a></li>
				<li class="etc_html"><a href="#" onclick="addAtt('html');return false;">HTML 편집</a></li>
				<li class="etc_bar"><a href="#" onclick="addAtt('bar');return false;">구분선</a></li>
			</ul>
		</div><!--// att-->

		<div id="canvas_wrap">
			<div id="scroll_wrap">
				<div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>
				<div class="viewport">
					<div id="editeCanvas" class="overview">
						<ul class="editor_box" id="editor_box"></ul>
					</div>
				</div>
			</div>
			<div id="page_wrap">
				<div class="page_wrap_center">
					<a href="#" class="page_wrap_page page1 on1">&nbsp;</a>
					<a href="#" class="page_wrap_page page2">&nbsp;</a>
					<a href="#" class="page_wrap_page page3">&nbsp;</a>
					<a href="#" class="page_wrap_page page4">&nbsp;</a>
					<a href="#" class="page_wrap_page page5">&nbsp;</a>
				</div>
				<a href="#" class="page_add"></a>
			</div>
			<div id="buttons">
				<a href="#" onclick="" class="preview">미리보기</a>
				<a href="#" onclick="" class="save">저장하기</a>
			</div>
			<div id="uploadifyQueue" style="position:absolute;left:50%;top:50%;margin-left:-160px"></div>
		</div><!--// canvas_wrap -->
		

		
	</div><!--// wrap -->
<a href="http://www.ehancast.com/img.zip">샘플이미지 다운로드</a>
  </body>
</html>